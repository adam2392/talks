<!DOCTYPE html>
<html>
  <head>
    <title>MGC | SIMPLEX</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="fonts/quadon/quadon.css">
    <link rel="stylesheet" href="fonts/gentona/gentona.css">
    <link rel="stylesheet" href="slides_style.css">
    <script type="text/javascript" src="assets/plotly/plotly-latest.min.js"></script>
  </head>
  <body>
    <textarea id="source">




class: left,

name:opening


## Multiscale Graph Correlation:
### A Knowledge Representation System for Discovering  Latent Geometric Structure


PI: Joshua T. Vogelstein, Co-PIs: Carey E. Priebe, Cencheng Shen


<br><br><br>

<img src="images/funding/jhu_bme_blue.png" STYLE="HEIGHT:95px;"/>
<img src="images/funding/KNDI.png" STYLE="HEIGHT:95px;"/>

.foot[[jovo@jhu.edu](mailto:jovo at jhu dot edu)
  |  <http://neurodata.io/talks/mgc-simplex.html>]


---

# Outline

- Theoretical Results
- Numerical Analysis
- Real Data Experiments



---
class: middle

# .center[theoretical results]


---


### Our Goal


Build a knowledge represetation system with the following properties:

1. can answer various kinds of queries
2. has a rigorous mathematical and statistical framework
3. enables subject matter experts to encode domain-specific information including context


--

Requires definitions for query types to support and mathematical desiderata to satisfy


---

### Queries of Interest

Given $N$ entities, each measured with up to $M$ modalities, <br>
as well as directly measuring $R$ relationships (eg, FB friends), <br>
discover and decipher relationships between subsets of:

1. entities,
2. modalities.

---

#### Mathematical and Statistical Desiderata


1. .r[Sufficiency]: Operate in arbitrary measurable metric spaces
2. .r[Uncertainty]: Represent and quantify uncertainty
3. .r[Complexity]: Can discover arbitrarily complex relationships
4. .r[Consistency]: Sample estimator converges to truth
4. .r[Robustness]: Robust to model misspecifications
4. .r[Efficiency]: Computationally tractable/efficient






---



### Limitations of Existing Approaches

Every existing approach has severe limitations in $\geq$ 1 of these


1. .r[Sufficiency]: Renyi
2. .r[Uncertainty]: Isomap, Diffusion Wavelets
3. .r[Complexity]: Kendall, Spearman
4. .r[Consistency]: Maximal Correlation, MIC
4. .r[Robustness]: Pearson
4. .r[Efficiency]: TDA





---

#### Our Key Principles


1. all  knowledge  from the data is encoded in sets of relationships
2. the optimal set size is a function of the (data,query) pair

--

#### Our Basic Strategy

Given $N$ points each measured with up to $M$ modalities, build the following data structures:

1. For each modality
  1. choose a metric
  1. build the k-nearest neighbor graph, for all k=1,...,$N$
  2. build a (centered) pairwise distance matrix
3. Estimate the jointly optimal set of neighborhood sizes simultaneously across all modalities
3. For each modality, sparsify/truncate/censor its pairwise distance matrix to only include the those neighbors
4. Compute the Hadamard tensor product






---

### Multiscale Graph  Correlation

<img src="images/linear.png" alt="Drawing" style="position:absolute; TOP: 150px;  LEFT: 100px; height: 180px;"/>

--

<img src="images/Fig1B.png" alt="Drawing" style="position:absolute; TOP: 150px;  LEFT: 300px; height: 180px;"/>

<!-- --

<img src="images/Fig_centered1Panel2.png" alt="Drawing" style="position:absolute; TOP: 150px;  LEFT: 500px; height: 150px;"/> -->

--

<div style="position:absolute; TOP: 150px;  LEFT: 560px; height: 200px;">
dcorr(X,Y)=0.15, p-val < 0.001 <br> MGC(X,Y)=0.15,  p-val < 0.001
</div>


--

<img src="images/spiral.png" alt="Drawing" style="position:absolute; TOP: 400px;  LEFT: 100px; height: 180px;"/>

--

<img src="images/Fig8B.png" alt="Drawing" style="position:absolute; TOP: 400px;  LEFT: 300px; height: 180px;"/>

<!-- --

<img src="images/Fig_centered8Panel2.png" alt="Drawing" style="position:absolute; TOP: 400px;  LEFT: 500px; height: 150px;"/> -->


--

<div style="position:absolute; TOP: 400px;  LEFT: 560px; height: 200px;">
dcorr(X,Y)=0.01, p-val 0.3 <br> MGC(X,Y)= .r[0.13], p-val < .r[0.001]
</div>




---

### Theoretical Results and Limitations


MGC theoretically satisfies all of the desiderata, with the following caveats, MGC requires

1. .r[Sufficiency]: metric to be of "strong negative type"
2. .r[Uncertainty]: samples are iid and $E[X_m^2] < \infty$
3. .r[Complexity]: $R=2$ (for now)
4. .r[Consistency]: $\mathcal{O}(1/n)$
4. .r[Robustness]: ish
4. .r[Efficiency]: $\mathcal{O}(n \log n)$


---
class: middle

# .center[numerical analysis]

---
class: top, left

### Setup

- sample $(x_i, y_i) \sim F$ iid for $i=1,\ldots, n$ for 20 different functions
- in each case, there is *some* true but unknown relationship
- *power* is the probability detecting a relationship
<!-- -  $\beta_n(t)$ := power of test statistic $t$ given $n$ samples -->
- $N_\beta$ is the # of samples required to achieve power $\beta$






---
class: top, left

### 20 Different Functions (1D version)


<img src="images/FigSimVisual.png"  alt="local"  style="width: 100%;"/>



---
class: top, left

###  MGC Outperforms Benchmarks




<img src="images/FigHDPower.png"  alt="local"  style="width: 100%;"/>
<!-- -- -->
<!-- <img src="images/FigHDPowerSummarySize.png"  alt="local"  style="position:absolute;  LEFT: 460px; height: 280px;"/> -->


<!-- .center[
<img src="https://github.com/neurodata/MGC/raw/master/Figures/FigHDPowerMGCM.png" alt="Drawing" style="width: 900px;"/>
] -->

---

###  MGC Outperforms Benchmarks


Relative sample size to achieve 85% power

<img src="images/MGC_power_table.png"  alt="local"  style="width: 100%;"/>

Other approaches with the sample theoretical properties and limitations (HHG, dCorr, HSIC)
tend to require **double** or **triple** the samples to achieve the same power



---
class: middle

# .center[real data experiments]


---

### MGC Biomedical Applications

- detecting dependence
- graph topology vs node attributes
- signal subgraph detection
- manifold learning / embedding
- effect size estimation
- feature selection/screening
- machine learning / classification





---


### DARPA SIGMA Data


Some radioactive substance is moving around, and we have

- 3 days of data
- 25 sensors
- 15 features per sensor
- 2 features of interest of particular: gamma and neutron



---



---

###  Summary





---

### Next Steps



---

### References


- MGC foundational theory [[1]](https://arxiv.org/abs/1710.09768)
- MGC biomedical applications  [[2]](https://arxiv.org/abs/1609.05148)
- MGC for independence between graph topology & attributes [[3]](https://arxiv.org/abs/1703.10136)
- MGC for signal subgraph detection [[4]](https://arxiv.org/abs/1801.07683)
- MGC for clustering (ish) [[5]](https://arxiv.org/abs/1710.09859)
- Equivalence of dCorr and HSIC [[6]](https://arxiv.org/abs/1806.05514)
- R package:  [CRAN link](https://cran.r-project.org/web/packages/mgc/index.html); ~80  monthly downloads





---
class: top, left

### Acknowledgements


<div class="container">
  <img src="faces/cep.png"/>
  <div class="centered">Carey Priebe</div>
</div>



<div class="container">
  <img src="faces/cshen.jpg"/>
  <div class="centered">Cencheng Shen</div>
</div>

<div class="container">
  <img src="faces/shangsi.jpg"/>
  <div class="centered">Shangsi Wang</div>
</div>

<div class="container">
  <img src="faces/youjin-lee.jpg"/>
  <div class="centered">Youjin Lee</div>
</div>

<div class="container">
  <img src="faces/ebridge.jpg"/>
  <div class="centered">Eric Bridgeford</div>
</div>


<span style="font-size:200%; color:red;">&hearts;, &#129409;, &#128106;, &#127758;, &#127756;</span>



<img src="images/funding/nsf_fpo.png" STYLE="HEIGHT:95px;"/>
<img src="images/funding/nih_fpo.png" STYLE="HEIGHT:95px;"/>
<img src="images/funding/darpa_fpo.png" STYLE=" HEIGHT:95px;"/>
<img src="images/funding/iarpa_fpo.jpg" STYLE="HEIGHT:95px;"/>
<img src="images/funding/KAVLI.jpg" STYLE="HEIGHT:95px;"/>
<img src="images/funding/schmidt.jpg" STYLE="HEIGHT:95px;"/>


---


### Questions?




<img src="images/liono.JPG" STYLE="position:absolute; TOP:110px;  HEIGHT:500px;"/>





<!-- background-image: url("images/OCPaper.png")
background-size: contain;
 -->
<!-- <img src="images/OCPaper.png" style="width: 100%;"/> -->




    </textarea>
    <!-- <script src="https://gnab.github.io/remark/downloads/remark-latest.min.js"></script> -->
    <script src="remark-latest.min.js"></script>
    <script src="assets/KaTeX/0.5.1/katex.min.js"></script>
    <script src="assets/KaTeX/0.5.1/auto-render.min.js"></script>
    <link rel="stylesheet" href="assets/KaTeX/0.5.1/katex.min.css">
    <script type="text/javascript">
      var options = {};
      var renderMath = function() {
        renderMathInElement(document.body);
        // or if you want to use $...$ for math,
        renderMathInElement(document.body, {delimiters: [ // mind the order of delimiters(!?)
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false},
            {left: "\\[", right: "\\]", display: true},
            {left: "\\(", right: "\\)", display: false},
        ]});
      }
      var slideshow = remark.create(options, renderMath);

    </script>
  </body>
</html>
