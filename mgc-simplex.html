<!DOCTYPE html>
<html>
  <head>
    <title>MGC | SIMPLEX</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="fonts/quadon/quadon.css">
    <link rel="stylesheet" href="fonts/gentona/gentona.css">
    <link rel="stylesheet" href="slides_style.css">
    <script type="text/javascript" src="assets/plotly/plotly-latest.min.js"></script>
  </head>
  <body>
    <textarea id="source">




class: left,

name:opening


## Multiscale Graph Correlation:
### A Knowledge Representation System for Discovering  Latent Geometric Structure


PI: Joshua T. Vogelstein, Co-PIs: Carey E. Priebe, Cencheng Shen


<br><br><br>

<img src="images/funding/jhu_bme_blue.png" STYLE="HEIGHT:95px;"/>
<img src="images/funding/KNDI.png" STYLE="HEIGHT:95px;"/>

.foot[[jovo@jhu.edu](mailto:jovo at jhu dot edu)
  |  <http://neurodata.io/talks/mgc-simplex.html>]



---


### Our Goal


Build a knowledge represetation system with the following properties:

1. can answer various kinds of queries
2. has a rigorous mathematical and statistical framwork
3. enables subject matter experts to encode domain-specific information including context


--

### Our Key Principles



1. all of the knowledge available is encoded in sets of relationships
2. the optimal set size is a function of the (data,query) pair

---

### Limitations of Existing Approaches

1. lack rigorous statistical theory/justification
1. must choose set size a priori
2. computational complexity



---

### Our Basic Strategy

Given n points each measured with m modalities, build the following data structures:

1. For each modality
  1. choose a metric
  1. build the k-nearest neighbor graph, for all k=1,...,n
  2. build a (centered) pairwise distance matrix
3. Estimate the jointly optimal set of neighborhood sizes simultaneously across all modalities,  $K=$ ($k^*_1$,...,$k^m$)
3. For each modality, sparsify/truncate/censor its pairwise distance matrix to only include the $K$ neighbors
4. Compute the Hadamard tensor product





---
class: center

#### Formal Definition of Independence Testing

<br><br>

<!-- <img src="images/setup.png" alt="Drawing" style="width: 60%;"/> -->




$$(X\_i,Y\_i) \sim F\_{XY} = F\_{X|Y} F\_Y, \quad i \in \{1,\ldots,n\}$$

$$H\_0: F\_{XY} = F\_X F\_Y $$
$$H\_A: F\_{XY} \neq F\_X F\_Y $$





---

### local distance correlation

<img src="images/linear.png" alt="Drawing" style="position:absolute; TOP: 150px;  LEFT: 100px; height: 180px;"/>

--

<img src="images/Fig1B.png" alt="Drawing" style="position:absolute; TOP: 150px;  LEFT: 300px; height: 180px;"/>

<!-- --

<img src="images/Fig_centered1Panel2.png" alt="Drawing" style="position:absolute; TOP: 150px;  LEFT: 500px; height: 150px;"/> -->

--

<div style="position:absolute; TOP: 150px;  LEFT: 560px; height: 200px;">
dcorr(X,Y)=0.15, p-val < 0.001 <br> MGC(X,Y)=0.15,  p-val < 0.001
</div>


--

<img src="images/spiral.png" alt="Drawing" style="position:absolute; TOP: 400px;  LEFT: 100px; height: 180px;"/>

--

<img src="images/Fig8B.png" alt="Drawing" style="position:absolute; TOP: 400px;  LEFT: 300px; height: 180px;"/>

<!-- --

<img src="images/Fig_centered8Panel2.png" alt="Drawing" style="position:absolute; TOP: 400px;  LEFT: 500px; height: 150px;"/> -->


--

<div style="position:absolute; TOP: 400px;  LEFT: 560px; height: 200px;">
dcorr(X,Y)=0.01, p-val 0.3 <br> MGC(X,Y)= .r[0.13], p-val < .r[0.001]
</div>


---

### multiscale distance correlation

- compute local dcorr **at all scales**
- find scale with **max** smoothed test statistic
- permutation test to determine p-value



---
class: top, center

### Multiscale Generalized Correlation (MGC)


<!-- <img src="https://github.com/neurodata/MGC/raw/master/Figures/FigA.png" alt="Drawing" style="width: 900px;"/> -->
<img src="images/Fig1.png"  style="width: 780px;"/>
--

<img src="images/Fig8.png"  style="width: 780px;"/>
--

<img src="images/flowchart.png"  style="width: 780px;"/>


---
class: top, left


#### Intuitive Desiderata of Testing Procedure

<br>

1. Performant under *any* joint distribution
  - low- and high-dimensional
  - Euclidean and structured data (eg, sequences, images, networks, shapes)
  - linear and nonlinear relationships
6. Reveals the "geometry"  of dependence
5. Is computational efficiency


Provides a tractable algorithm that addresses the two motivating questions:

- Question 1: are the two related at all?
- Question 2: how are they related?


---
class: middle, center

# simulations

---
class: top, left

### Definitions

- **power** is the probability of rejecting the null when the alternative is true
<!-- -  $\beta_n(t)$ := power of test statistic $t$ given $n$ samples -->
- $N_\beta(t)$ := the # of samples required to achieve power $\beta$ using test statistic $t$



### Empirical Desiderata

1. statistical efficiency: $$N\_\beta(t') / N\_\beta( \text{MGC}) \geq 1  \text{ for all }
  n, \, d, \, F\_{XY}, \text{ and } t' $$
  <!-- $$\beta\_n(\text{MGC}) > \beta\_n(t')  \text{ for all } -->
  <!-- n, \, t' \in \mathcal{T}, \text{ and } F\_{XY} $$ -->
2. quantification of relationship



---
class: top, left

### 20 Different Functions (1D version)


<img src="images/FigSimVisual.png"  alt="local"  style="width: 100%;"/>



---
class: top, left

###  MGC Outperforms Benchmarks


<br>


<img src="images/Fig2_jk.png"  alt="local"  style="width: 100%;"/>
<!-- -- -->
<!-- <img src="images/FigHDPowerSummarySize.png"  alt="local"  style="position:absolute;  LEFT: 460px; height: 280px;"/> -->


<!-- .center[
<img src="https://github.com/neurodata/MGC/raw/master/Figures/FigHDPowerMGCM.png" alt="Drawing" style="width: 900px;"/>
] -->

---
class: top, left

###  MGC Outperforms Benchmarks


<br>


<img src="images/table_benchmarks.png"  alt="local"  style="width: 100%;"/>



---
class: top, left

#### MGC Reveals Geometry of Dependence

<img src="images/Fig1DHeat.png"  alt="local"  style="width: 100%;"/>

<!-- .center[
<img src="https://github.com/neurodata/MGC/raw/master/Figures/FigHDHeat.png"  style="width: 900px;"/>
] -->


---
class: top, left


### Empirical Desiderata

<br>


1. $N\_\beta(t') / N\_\beta( \text{MGC}) \geq 1  \text{ for all }
  n, \, d, \, F\_{XY}, \text{ and } t' $
  <!-- $$\beta\_n(\text{MGC}) > \beta\_n(t')  \text{ for all } -->
  <!-- n, \, t' \in \mathcal{T}, \text{ and } F\_{XY} $$ -->
2. quantification of relationship


---
class: middle, center

# theory


---
class: top, left


### Theoretical Desiderata

<!-- <br> -->

|  name | principle |
|  ---   | --- |
|  boundedness | $0 \leq t,T \leq 1 $|
| symmetric   | $T(X,Y) = T(Y,X)$ |
|  1-linear. | $  T= 1 \Leftrightarrow y = A x + b$ |
|  0-indep. | $T=0 \Leftrightarrow H(X \lvert Y) = H(X)$ |
|  ortho. invar. | $T(X,Y) = T(a_1 + b_1  C_1  X, a_2 + b_2  C_2  Y)$ |

--
|  univ. consist. | $\beta\_n(T) \to 1, \quad \forall \, F\_{XY}$ |
|  dominance | $\beta\_n(T) \geq \beta\_n(T'), \, \forall n,\, T' \in \mathcal{T}, \forall F\_{XY}$ |
|  convergence | $\beta_n(t) \to \beta_n(T)$ as $n \to \infty$ |
<!-- |  efficiency | $\mathbb{E}\beta_n(t) \geq \mathbb{E}\beta_n(t'), \, \forall n, t' \in \mathcal{T}$ | -->

<!-- | | comp. efficiency | $\mathcal{O}(d n^2 \log n)$ space and time | -->
<!-- 9. "reveal the "geometry/topology" of the relationship" -->

---
class: top, left

#### MGC is a Reasonable Dependence Statistic

<br>

Thm: Oracle MGC has the following properties:

- 0 &geq;  MGC &geq; 1
- MGC = 0 only under independence
- MGC is symmetric
- MGC = 1 only under linear relationship
- MGC is invariant to rotation, translation, and scale of X and/or Y


---
class: left

### MGC has power 1 for all F<sub>XY</sub>
<!-- Thm 1: $$\beta_n(c_t^*) \rightarrow 1 \text{ as } n \to \infty$$ -->
<!-- Oracle MGC is consistent whenever Global Counterpart is
<br>
 -->

 <br><br>

 Lemma: \\( \beta_n (T^*) \to 1  \\) as \\( n \to \infty \\) whenever \\( E [X] < \infty. \\)

<!-- <img src="images/thm1.png"  style="position:absolute; LEFT: 200px; TOP: 300px; height: 40px;"/> -->

---
class: left

### Linear: Local < Global

<!-- Thm 2: If x is linearly dependent on y, then for any n it always holds that $\beta_n(c_t^*) = \beta_n(c_t)$ -->

<br><br>

Lemma: If x is linearly dependent on y, then it always holds that
$$ \beta_n(T^*) = \beta_n(T) $$

for any n.


<!-- <img src="images/thm2.png"  style="position:absolute; LEFT: 60px; TOP: 300px; height: 80px;"/> -->


---
class: left

### (Certain) Nonlinear: Local > Global


<br><br>

Lemma: There exists f and n such that

$$\beta_n( T^{k,l} ) > \beta_n(T). $$



<!-- <img src="images/thm3.png"  style="width: 800px;"/> -->


---
class: left


### MGC > Dcorr

<br><br>

Thm: Oracle MGC statistically dominates dcorr, that is,

$$\beta_n( T^* ) \geq \beta_n(T). $$


<!-- <img src="images/thm4.png"  style="width: 800px;"/> -->


---
class: left

### Sample MGC Converges


<br>

Thm: For any  F<sub>XY</sub> with finite 1st moment,

$\beta_n(t^*) \to \beta_n(T^\ast)$ as $n \to \infty$

if and only if  $\sigma_X$ and $\sigma_Y$  are of strong negative type.



---
class: top, left


### Theoretical Desiderata

<br>

|  name | principle |
|  ---   | --- |
|  boundedness | &#x2705;|
|  symmetric | &#x2705;|
|  linear. | &#x2705; |
|  0-indep. | &#x2705; |
|  ortho. invar. | L$_p$ |
|  univ. consist. | &#x2705;  |
|  dominance | &#x2705; |
|  convergence | &#x2705; |



---
class: middle, center

# real data

---
class: top, left


### Real Data Desiderata

<br>

1. when we believe dependence, MGC obtains a small p-value
2. MGC provides insight into the geometry of real dependence
3. when there is no dependence, MGC correcly controls FPR


---
class: top, left

### MGC Discovers Relationships between Brain & Mental Properties

<br><br>

<img src="images/table.png" alt="Drawing" style="width: 100%;"/>


---
class: top, left

### MGC Reveals Geometry of Real Data


<img src="images/Fig4_jk_v5.png" style="width: 100%;"/>


---

### Overall Summary


- Oracle MGC theoretically dominates, even in finite samples
- MGC empirically nearly dominates on extensive simulations
- Visual quantitative characterization of arbitrary relationships
- MGC reveals geometry of dependence in real data

<br>
- MGC mitigate "post selection inference" problems


---

### Some Extensions

<br>

- Foundational theory for MGC [[1]](https://arxiv.org/abs/1710.09768)
- MGC for independence between graph topology & attributes [[2]](https://arxiv.org/abs/1703.10136)
- MGC for signal subgraph detection [[3]](https://arxiv.org/abs/1801.07683)
- MGC for clustering (ish) [[4]](https://arxiv.org/abs/1710.09859)

<br>

- MGC for K-sample testing
- MGC for feature selection
- MGC for batch effect detection
- MGC for effect size characterization


---

### Next Steps

<br><br>

- Make R package from open source code ([github link](https://github.com/neurodata/mgc))
- Scale up for larger n



---

### Computational Desiderata

1. fast
2. open source

<br>

| Method | Complexity |
| :---: | :---: |
| Dcorr |  n<sup>2</sup> |
 | HHG |  n<sup>2</sup> log n |
| MGC |  n<sup>2</sup> log n / T  |

- MATLAB and R code at [http://neurodata.io/tools#MGC](http://neurodata.io/tools#MGC)



---
class: middle

# <center>Discussion</center>



---
class: top, left

### Acknowledgements


<div class="container">
  <img src="faces/cep.png"/>
  <div class="centered">Carey Priebe</div>
</div>

<div class="container">
  <img src="faces/randal.jpg"/>
  <div class="centered">Randal Burns</div>
</div>

<div class="container">
  <img src="faces/mim.jpg"/>
  <div class="centered">Michael Miller</div>
</div>

<div class="container">
  <img src="faces/bcaffo.jpg"/>
  <div class="centered">Brian Caffo</div>
</div>

<div class="container">
  <img src="faces/milham.jpg"/>
  <div class="centered">Michael Milham</div>
</div>

<div class="container">
  <img src="faces/dtward.jpg"/>
  <div class="centered">Daniel Tward</div>
</div>

<div class="container">
  <img src="faces/minh.jpg"/>
  <div class="centered">Minh Tang</div>
</div>

<div class="container">
  <img src="faces/avanti.jpg"/>
  <div class="centered">Avanti Athreya</div>
</div>

<div class="container">
  <img src="faces/vince.jpg"/>
  <div class="centered">Vince Lyzinski</div>
</div>

<div class="container">
  <img src="faces/dpmcsuss.jpg"/>
  <div class="centered">Daniel Sussman</div>
</div>

<div class="container">
  <img src="faces/yichen.jpg"/>
  <div class="centered">Yichen Qin</div>
</div>

<div class="container">
  <img src="faces/youngser.jpg"/>
  <div class="centered">Youngser Park</div>
</div>

<div class="container">
  <img src="faces/cshen.jpg"/>
  <div class="centered">Cencheng Shen</div>
</div>

<div class="container">
  <img src="faces/shangsi.jpg"/>
  <div class="centered">Shangsi Wang</div>
</div>

<div class="container">
  <img src="faces/gkiar.jpg"/>
  <div class="centered">Greg Kiar</div>
</div>

<div class="container">
  <img src="faces/ebridge.jpg"/>
  <div class="centered">Eric Bridgeford</div>
</div>

<div class="container">
  <img src="faces/vikram.jpg"/>
  <div class="centered">Vikram Chandrashekhar</div>
</div>

<div class="container">
  <img src="faces/tyler.jpg"/>
  <div class="centered">Tyler Tomita</div>
</div>

<div class="container">
  <img src="faces/james.jpg"/>
  <div class="centered">James Brown</div>
</div>

<div class="container">
  <img src="faces/disa.jpg"/>
  <div class="centered">Disa Mhembere</div>
</div>

<div class="container">
  <img src="faces/drishti.jpg"/>
  <div class="centered">Drishti Mannan</div>
</div>

<div class="container">
  <img src="faces/jesse.jpg"/>
  <div class="centered">Jesse Patsolic</div>
</div>

<div class="container">
  <img src="faces/falk_ben.jpg"/>
  <div class="centered">Benjamin Falk</div>
</div>

<div class="container">
  <img src="faces/kwame.jpg"/>
  <div class="centered">Kwame Kutten</div>
</div>

<div class="container">
  <img src="faces/perlman.jpg"/>
  <div class="centered">Eric Perlman</div>
</div>





<img src="images/funding/nsf_fpo.png" STYLE="HEIGHT:95px;"/>
<img src="images/funding/nih_fpo.png" STYLE="HEIGHT:95px;"/>
<img src="images/funding/darpa_fpo.png" STYLE=" HEIGHT:95px;"/>
<img src="images/funding/iarpa_fpo.jpg" STYLE="HEIGHT:95px;"/>
<img src="images/funding/KAVLI.jpg" STYLE="HEIGHT:95px;"/>
<img src="images/funding/schmidt.jpg" STYLE="HEIGHT:95px;"/>


---


### Questions? Now hiring!

.pull-left[
| task |  link |
| --- | --- |
| testing | [MGC](https://github.com/neurodata/mgc) |
| dim red | [LOL](https://github.com/neurodata/LOL) |
| classify | [RerF](https://github.com/neurodata/R-RerF/)  |
| graph stats |  [graphstats](https://github.com/neurodata/graphstats/)
|  registration | [ndreg](https://github.com/neurodata/ndreg) |
| email | [jovo@jhu.edu](mailto:jovo@jhu.edu) |
| web |  [neurodata.io](http://neurodata.io/) |
| startup | [gigantum.com](http://gigantum.com/) |

<span style="font-size:200%; color:red;">&hearts;, &#129409;, &#128106;, &#127758;, &#127756;</span>

]

<br>



<img src="images/liono.JPG" STYLE="position:absolute; TOP:110px; LEFT:480px; HEIGHT:500px;"/>





<!-- background-image: url("images/OCPaper.png")
background-size: contain;
 -->
<!-- <img src="images/OCPaper.png" style="width: 100%;"/> -->




    </textarea>
    <!-- <script src="https://gnab.github.io/remark/downloads/remark-latest.min.js"></script> -->
    <script src="remark-latest.min.js"></script>
    <script src="assets/KaTeX/0.5.1/katex.min.js"></script>
    <script src="assets/KaTeX/0.5.1/auto-render.min.js"></script>
    <link rel="stylesheet" href="assets/KaTeX/0.5.1/katex.min.css">
    <script type="text/javascript">
      var options = {};
      var renderMath = function() {
        renderMathInElement(document.body);
        // or if you want to use $...$ for math,
        renderMathInElement(document.body, {delimiters: [ // mind the order of delimiters(!?)
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false},
            {left: "\\[", right: "\\]", display: true},
            {left: "\\(", right: "\\)", display: false},
        ]});
      }
      var slideshow = remark.create(options, renderMath);

    </script>
  </body>
</html>
